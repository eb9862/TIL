# 텐서(Tensor)

## 텐서의 정의

- 텐서(Tensor) 는 벡터와 행렬을 포함하는 더 일반적인 개념

- 차원(rank) 에 따라 다음과 같이 분류됩니다
  - 스칼라 (0차 텐서)
  - 벡터 (1차 텐서)
  - 행렬 (2차 텐서)
  - 고차원 배열 (3차 이상 텐서)

## 텐서의 차원과 형태

- 차원(rank): 축(axis)의 개수
- 형태(shape): 각 축에 해당하는 원소의 개수
- 예시
  - 스칼라: ()
  - 벡터: (n,)
  - 행렬: (n, m)
  - 3차 텐서: (n, m, k)

## 텐서의 기하학적 의미

- 벡터 → 공간의 점

- 행렬 → 공간의 점들의 집합 (데이터셋)

- 텐서 → 다차원 데이터를 나타내는 일반화된 객체

- 예시
  - 흑백 이미지 → 행렬 (2D tensor)
  - 컬러 이미지 (RGB) → 3차원 텐서
  - 동영상 → 4차원 텐서 (프레임, 높이, 너비, 채널)

## 텐서 연산

### 기본 연산

- 벡터, 행렬의 연산처럼 텐서끼리 같은 모양을 가지면 덧셈, 뺄셈, 성분곱을 계산할 수 있습니다

- 텐서의 곱셈은 NumPy 연산마다 다르게 정의되기 때문에 주의가 필요
  - `np.dot()` / `np.matmul`
  - 행렬에서는 같은 기능을 수행하지만, 3차원 이상부터는 다르게 동작

### einsum

- `einsum`은 아인슈타인 표기법(Einstein summation convention)을 사용한 연산 방식
- 다양한 텐서 곱셈을 직관적으로 표현할 수 있습니다

```python
import numpy as np

a = np.arange(25).reshape(5,5)
np.einsum('ii', a) # 대각 성분을 모두 더한 값
np.einsum('ii -> i', a) # 대각 성분 추출
np.einsum('ij -> i', a) # 축에 대한 합계
```

```python
X = np.arange(9).reshape(3,3)
Y = np.arange(9).reshape(3,3)
np.einsum('ij->ji', X) # 전치 행렬
np.einsum('ik, kj -> ij', X, Y) # 행렬 X, Y의 행렬 곱셈
```

### einops

- einops와 함께 사용하면 텐서 연산을 더 직관적으로 다룰 수 있습니다

```python
import einops

# 0번재 차원과 1번째 차원 전치
einops.rearrange(ims[0], "h w c -> w h c")

# 0번째 차원과 1번째 차원을 합쳐 3차원으로 축소
rearrange(ims, "b h w c -> (b h) w c")
```
<br>

> 2025.09.09 작성