# 행렬(Matrix)

> 참고자료: 공돌이의 수학정리노트 (Angelo's Math Notes)<br>
> 2025.09.08 작성

## 행렬의 정의

- 행렬(Matrix) 은 벡터를 원소로 가지는 2차원 배열입니다

- 크기: $n \times m$ (행 $n$, 열 $m$)

- 원소 표기: $x_{ij}$ (i번째 행, j번째 열)
원소 표기: $x_{ij}$ (i번째 행, j번째 열)	​

<img src="https://i.ibb.co/yc6qn6bJ/image.png" alt="image" border="0">

- 특정 행을 고정하면 행벡터, 특정 열을 고정하면 열벡터라 부릅니다

- 전치행렬(transpose) 은 행과 열을 바꾼 행렬입니다

## 행렬을 이해하는 방법

- 벡터가 공간에서 한 점이라면, 행렬은 여러 점의 집합입니다

- 행렬의 행(row) 은 개별 데이터,
열(column) 은 변수(feature) 에 해당합니다
→ 데이터셋을 표현할 때 자주 사용됨

## 행렬의 연산

### 덧셈 / 뺄셈

- 같은 크기의 행렬끼리 원소별로 더하거나 뺍니다

### 성분곱 (Hadamard Product)

- 같은 크기의 행렬끼리 원소별 곱을 수행합니다

### 스칼라 곱

- 스칼라 $\alpha$ 를 행렬 $X$에 곱하면 모든 원소에 곱해집니다.

### 행렬 곱 (Matrix Multiplication)

- $X$가 $n \times m$, $Y$가 $m \times p$ 크기일 때,

- 결과 $Z = XY$ 는 $n \times p$ 크기를 가짐

- $z_{ij}​=∑_{k=1}^m​x_{ik}​y_{kj}​$

```python
X = np.array([[1, 2, 3],
                [4, 5, 6]])
Y = np.array([[1, 2],
                [3, 4],
                [5, 6]])
X @ Y # numpy에서 `@` 연산 사용
```

### 행렬의 내적

$⟨X,Y⟩=∑_{k}​x_{ik}​y_{jk}​$

```python
X = np.array([[1, 2, 3],
                [4, 5, 6],
                [7, 8, 9]])
Y = np.array([[1, 3, 5],
                [2, 3, 4]])
np.inner(X, Y) # numpy에서 `@` 연산 사용
```

## 역행렬

- 정방행렬 $A \in \mathbb{R}^{n \times n}$ 에 대해 $A^{-1}$ 은 다음 조건을 만족하는 행렬입니다

- $AA^−1=A^{−1}A=I_n​$

  - 여기서 $I_n$은 단위행렬(identity matrix)입니다

### 역행렬의 존재할 조건

1. 정방행렬(Square Matrix)이어야 함
2. Full Rank
    - 행렬 $A$의 행 또는 열이 선형독립(linearly independent) 이어야 합니다
    - 즉, rank(A) = n 이어야 함
3. 행렬식(determinant) 조건
    - 행렬식 $det(A) ≠ 0$ → 역행렬 존재

### 응용 - 연립방정식 풀기

- 연립방정식 $A \mathbf{x} = \mathbf{b}$를 풀 때, $A$의 역행렬이 존재한다면 해는 다음과 같습니다:

  - $x=A^{−1}b$

```python
import numpy as np

x = np.linalg.pinv(A) @ b
```

## 행렬식 (Determinant)

- 행렬식(determinant)의 절대값은 행렬을 구성하는 벡터로 만들어낸 다포체(polytope)의 부피의 크기와 같습니다

- 만약 행렬을 구성하는 벡터들이 서로 평행한다면 평행사변형을 만들어내지 못하므로 행렬식이 0입니다<br>⇒ 역행렬이 없음

- 행렬을 구성하는 벡터 일부를 선형결합해서 다른 벡터를 만들어낼 수 있다면 다포체를 만들어내는게 불가능하므로 행렬식이 0이다<br>
⇒ 역행렬이 없음

  - 다른 벡터로 선형결합이 되지 않는 경우, 선형독립(linearly independent)이라고 함

<img src="https://i.ibb.co/Pv0jRBfB/image.png" alt="image" border="0">

<img src="https://i.ibb.co/yF9Ft4tg/image.png" alt="image" border="0">

## 유사 역행렬

- 일반적인 행렬은 역행렬이 항상 존재하지 않음
→ 정방행렬이 아니거나, $\det(A) = 0$ 인 경우 역행렬을 정의할 수 없음

- 이때 사용하는 것이 유사 역행렬(Pseudo-inverse), 특히 무어–펜로즈(Moore–Penrose) 유사 역행렬입니다

- A의 rank 값이 min{n, m}이면 공식을 쓸 수 있습니다
  - $n \geq m$ → $A^+ = (A^TA)^{-1}A^T$
  - $n \leq m$ → $A^+ = A^T(AA^T)^{-1}$

  - rank 값은 행렬을 이루는 벡터 중 선형 독립인 벡터의 개수를 의미

### 응용 - 선형회귀분석

- `np.linalg.pinv()`를 이용하면 데이터를 선형모델(linear model)로 해석하는 선형회귀식을 찾을 수 있습니다

- ...